<!--
  ~ Copyright 2014 Stephan Fellhofer
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<atlassian-plugin key="${project.groupId}.${project.artifactId}" name="${project.name}" plugins-version="2">
    <plugin-info>
        <description>${project.description}</description>
        <version>${project.version}</version>
        <vendor name="${project.organization.name}" url="${project.organization.url}"/>
        <param name="plugin-icon">images/pluginIcon.png</param>
        <param name="plugin-logo">images/pluginLogo.png</param>
    </plugin-info>

    <!-- add our i18n resource -->
    <resource type="i18n" name="i18n" location="at.fellhofer.jira.adminhelper.i18n"/>

    <!-- add our web resources -->
    <!--
    <web-resource key="AdminHelper-resources" name="AdminHelper Web Resources">
        <dependency>com.atlassian.auiplugin:ajs</dependency>
        <dependency>com.atlassian.auiplugin:jquery</dependency>
        <dependency>com.atlassian.auiplugin:jquery-ui-other</dependency>

        <resource type="i18n" name="i18n" location="at.fellhofer.jira.adminhelper.i18n"/>
        <resource type="download" name="AdminHelper.css" location="/css/AdminHelper.css"/>
        <resource type="download" name="AdminHelper.js" location="/js/AdminHelper.js"/>
        <resource type="download" name="images/" location="/images"/>

        <context>AdminHelper</context>
    </web-resource>
    -->

    <web-resource name="Admin Web Resources" key="admin-resources">
        <dependency>com.atlassian.auiplugin:ajs</dependency>
        <resource type="download" name="admin.js" location="admin.js"/>
    </web-resource>

    <web-resource name="Create User Resources" key="create-resources">
        <dependency>com.atlassian.auiplugin:ajs</dependency>
        <resource type="download" name="create_user.js" location="create_user.js"/>
        <resource type="download" name="user_helper.js" location="user_helper.js"/>
    </web-resource>

    <web-resource name="Create User Resources" key="modify-resources">
        <dependency>com.atlassian.auiplugin:ajs</dependency>
        <resource type="download" name="modify_user.js" location="modify_user.js"/>
        <resource type="download" name="user_helper.js" location="user_helper.js"/>
    </web-resource>

    <web-resource name="Hardware Overview" key="hardware-resources">
        <dependency>com.atlassian.auiplugin:ajs</dependency>
        <dependency>com.atlassian.auiplugin:aui-experimental-table-sortable</dependency>
        <dependency>com.atlassian.auiplugin:aui-date-picker</dependency>
        <resource type="download" name="hardware_overview.js" location="hardware_overview.js"/>
    </web-resource>

    <!-- publish our component -->
    <!--
    <component key="myPluginComponent" class="at.fellhofer.jira.adminhelper.jira.MyPluginComponentImpl" public="true">
        <interface>at.fellhofer.jira.adminhelper.jira.MyPluginComponent</interface>
    </component>
    -->

    <servlet key="create-user-servlet" class="at.fellhofer.jira.adminhelper.CreateUserServlet">
        <url-pattern>/admin_helper/create_user</url-pattern>
    </servlet>

    <servlet key="modify-user-servlet" class="at.fellhofer.jira.adminhelper.ModifyUserServlet">
        <url-pattern>/admin_helper/modify_user</url-pattern>
    </servlet>

    <servlet key="admin-servlet" class="at.fellhofer.jira.adminhelper.AdminServlet">
        <url-pattern>/admin_helper/admin</url-pattern>
    </servlet>

    <servlet key="hardware-servlet" class="at.fellhofer.jira.adminhelper.HardwareServlet">
        <url-pattern>/admin_helper/hardware</url-pattern>
    </servlet>

    <!-- TODO delete me -->
    <servlet key="todo-list" class="at.fellhofer.jira.adminhelper.BlubTodoServlet">
        <url-pattern>/todo/list</url-pattern>
    </servlet>

    <component key="device" class="at.fellhofer.jira.adminhelper.activeobject.DeviceServiceImpl"/>
    <component key="deviceComments" class="at.fellhofer.jira.adminhelper.activeobject.DeviceCommentServiceImpl"/>
    <component key="hardwareModel" class="at.fellhofer.jira.adminhelper.activeobject.HardwareModelServiceImpl"/>
    <component key="lending" class="at.fellhofer.jira.adminhelper.activeobject.LendingServiceImpl"/>
    <component key="operatingSystem" class="at.fellhofer.jira.adminhelper.activeobject.OperatingSystemServiceImpl"/>
    <component key="producer" class="at.fellhofer.jira.adminhelper.activeobject.ProducerServiceImpl"/>
    <component key="typeOfDevice" class="at.fellhofer.jira.adminhelper.activeobject.TypeOfDeviceServiceImpl"/>


    <!-- import from the product container -->
    <component-import key="applicationProperties" interface="com.atlassian.sal.api.ApplicationProperties"/>
    <component-import key="templateRenderer" interface="com.atlassian.templaterenderer.TemplateRenderer"/>
    <component-import key="userManager" interface="com.atlassian.sal.api.user.UserManager"/>
    <component-import key="loginUriProvider" interface="com.atlassian.sal.api.auth.LoginUriProvider"/>
    <component-import key="pluginSettingsFactory"
                      interface="com.atlassian.sal.api.pluginsettings.PluginSettingsFactory"/>
    <component-import key="transactionTemplate" interface="com.atlassian.sal.api.transaction.TransactionTemplate"/>
    <component-import key="webSudoManager" interface="com.atlassian.sal.api.websudo.WebSudoManager"/>
    <component-import key="ao" name="Active Objects service"
                      interface="com.atlassian.activeobjects.external.ActiveObjects">
        <description>Component to access Active Objects functionality from the plugin</description>
    </component-import>
    <component key="tx-processor" name="Transactional Annotation Processor"
               class="com.atlassian.activeobjects.external.TransactionalAnnotationProcessor">
        <decription>Processes @Transactional annotations.</decription>
    </component>

    <template-context-item key="applicationPropertiesContextItem" component-ref="applicationProperties"
                           context-key="applicationProperties" name="Application Properties Context Item"/>

    <rest key="rest" path="/admin-helper" version="1.0">
        <description>Provides REST resources for the admin UI.</description>
    </rest>

    <ao key="ao-module">
        <description>The module configuring the Active Objects service used by this plugin</description>
        <entity>at.fellhofer.jira.adminhelper.activeobject.Device</entity>
        <entity>at.fellhofer.jira.adminhelper.activeobject.DeviceComment</entity>
        <entity>at.fellhofer.jira.adminhelper.activeobject.HardwareModel</entity>
        <entity>at.fellhofer.jira.adminhelper.activeobject.Lending</entity>
        <entity>at.fellhofer.jira.adminhelper.activeobject.OperatingSystem</entity>
        <entity>at.fellhofer.jira.adminhelper.activeobject.Producer</entity>
        <entity>at.fellhofer.jira.adminhelper.activeobject.TypeOfDevice</entity>
    </ao>

    <web-section key="admin-helper-config-section" location="admin_plugins_menu">
        <label key="admin_helper.admin.section"/>
    </web-section>

    <web-item key="create_user_link" section="admin_plugins_menu/admin-helper-config-section" name="Create User"
              weight="10">
        <label>Create User</label>
        <link linkId="create_user_link">/plugins/servlet/admin_helper/create_user</link>
    </web-item>

    <web-item key="modify_user_link" section="admin_plugins_menu/admin-helper-config-section" name="Modify User"
              weight="20">
        <label>Modify User</label>
        <link linkId="modify_user_link">/plugins/servlet/admin_helper/modify_user</link>
    </web-item>

    <web-item key="admin-helper-config-item" section="admin_plugins_menu/admin-helper-config-section"
              name="Helper Configuration" weight="30">
        <description>Link to AdminHelper-admin page.</description>
        <label key="admin_helper.admin.label"/>
        <link linkId="admin_helper-admin-link">/plugins/servlet/admin_helper/admin</link>
    </web-item>

</atlassian-plugin>